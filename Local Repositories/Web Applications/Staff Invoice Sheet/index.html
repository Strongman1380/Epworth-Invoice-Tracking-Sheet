<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Epworth Staff Timesheet</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Tab Navigation -->
        <div class="tabs-container">
            <button id="dashboardTab" class="tab-button active" onclick="showDashboard()">
                üìä Dashboard
            </button>
            <button id="timesheetTab" class="tab-button" onclick="showTimesheetEditor()">
                üìù Current Timesheet
            </button>
        </div>

        <!-- Dashboard View -->
        <div id="dashboardView" class="view-container active">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <h2>Timesheet Dashboard</h2>
                <button onclick="createNewTimesheet()" class="btn btn-primary btn-large">+ New Timesheet</button>
            </div>

            <!-- Search and Filters -->
            <div class="dashboard-controls">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Search timesheets...">
                </div>
                <div class="filters">
                    <select id="statusFilter">
                        <option value="all">All Status</option>
                        <option value="draft">Draft</option>
                        <option value="submitted">Submitted</option>
                    </select>
                    <select id="employeeFilter">
                        <option value="all">All Employees</option>
                        <!-- Populated dynamically -->
                    </select>
                    <button onclick="resetFilters()" class="btn btn-secondary">Clear Filters</button>
                </div>
            </div>

            <!-- Timesheet List -->
            <div id="timesheetList" class="timesheet-list">
                <!-- Populated by JavaScript -->
            </div>

            <!-- Address Manager Panel -->
            <div class="address-manager-section">
                <button onclick="toggleAddressManager()" class="btn btn-secondary address-manager-toggle">
                    üìç Manage Saved Addresses
                </button>

                <div id="addressManagerPanel" class="address-manager-panel" style="display: none;">
                    <div class="address-manager-header">
                        <h3>Saved Addresses</h3>
                        <p>Add, view, and delete frequently used addresses</p>
                    </div>

                    <div class="address-add-form">
                        <input type="text" id="manualAddressInput" placeholder="Enter address to save..." list="addressList">
                        <button onclick="addManualAddress()" class="btn btn-primary">+ Add Address</button>
                    </div>

                    <div id="addressListContainer" class="address-list-container">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Timesheet Editor View -->
        <div id="timesheetEditorView" class="view-container">
        <!-- Header Section -->
        <div class="header-section">
            <div class="version">Version- 9.8</div>

            <div class="legend">
                <div>V=Vac</div>
                <div>S=Sick</div>
                <div>H=Holiday</div>
            </div>

            <div id="autoSaveStatus" class="auto-save-status"></div>

            <div class="employee-info">
                <div class="info-row">
                    <label>Name:</label>
                    <input type="text" id="employeeName" placeholder="Enter employee name">
                </div>
                <div class="info-row">
                    <label>Supervisor:</label>
                    <input type="text" id="supervisorName" placeholder="Enter supervisor name">
                </div>
                <div class="info-row">
                    <label>Pay Period:</label>
                    <div class="pay-period-selector">
                        <input type="date" id="payPeriodStart" onchange="updatePayPeriod()">
                        <span class="period-separator">to</span>
                        <input type="date" id="payPeriodEnd" onchange="updatePayPeriod()">
                        <input type="hidden" id="payPeriod">
                    </div>
                </div>
            </div>

            <div class="signature-section">
                <p class="certification">I certify these hours are true and accurate to the best of my knowledge.</p>
                <div class="signature-fields">
                    <div class="signature-field">
                        <label>Employee Signature/Date</label>
                        <input type="text" id="employeeSignature" placeholder="Sign here">
                    </div>
                    <div class="signature-field">
                        <label>Supervisor Signature/Date</label>
                        <input type="text" id="supervisorSignature" placeholder="Sign here">
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button onclick="showDashboard()" class="btn btn-secondary">‚Üê Back to Dashboard</button>
            <button onclick="addNewRow()" class="btn btn-primary">+ Add Entry</button>
            <button onclick="saveTimesheet()" class="btn btn-success">Save Timesheet</button>
            <button onclick="exportToExcel()" class="btn btn-warning">Export to Excel</button>
            <button onclick="clearAll()" class="btn btn-danger">Clear All</button>
        </div>

        <!-- Timesheet Grid -->
        <div class="table-container">
            <table id="timesheetTable">
                <thead>
                    <tr class="header-row">
                        <th>SERVICE<br>TYPES</th>
                        <th>SERVICE CHOICES<br>PREP VIRTUAL</th>
                        <th>TRAVEL<br>COMMENTS</th>
                        <th>Last Name, First Name<br>Name of Client(s)</th>
                        <th>Master<br>Case #</th>
                        <th>Date of<br>Service<br>MM/DD/YY</th>
                        <th>hrs:mins<br>Time in</th>
                        <th>hrs:mins<br>Time out</th>
                        <th>Drive From Address</th>
                        <th>Drive To Address</th>
                        <th class="miles-col">Miles</th>
                        <th>Staff<br>Name</th>
                        <th class="calc-col">Transport<br>Bill Time</th>
                        <th class="calc-col">Total<br>Mileage</th>
                        <th class="calc-col billable-col">Billable<br>Hours</th>
                        <th class="calc-col">IndHrs -<br>Drive Non-Bill</th>
                        <th class="calc-col">Indirect<br>Hours</th>
                        <th class="calc-col">Drive<br>Total</th>
                        <th class="calc-col">DAILY<br>TOTAL</th>
                        <th class="calc-col">Mileage<br>Reimb.</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="timesheetBody">
                    <!-- Rows will be generated by JavaScript -->
                </tbody>
                <tfoot>
                    <tr class="totals-row">
                        <td colspan="10" class="totals-label">TOTALS:</td>
                        <td id="totalMiles">0.0</td>
                        <td></td>
                        <td id="totalTransportBillTime">0.0</td>
                        <td id="totalMileageTotal">0.0</td>
                        <td id="totalBillableHours">0.0</td>
                        <td id="totalIndHrsDriveNonBill">0.0</td>
                        <td id="totalIndirectHours">0.0</td>
                        <td id="totalDriveTotal">0.0</td>
                        <td id="totalDailyTotal">0.0</td>
                        <td id="totalMileageReimb">$0.00</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Hidden inputs for Google Maps API -->
        <input type="hidden" id="googleMapsApiKey" value="">
        </div>
        <!-- End Timesheet Editor View -->
    </div>

    <!-- Datalist for saved addresses -->
    <datalist id="addressList"></datalist>

    <!-- Load SheetJS for Excel export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Google Maps JavaScript API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDHuKbelQ7u7Ukb5BvfGnx_-5dvz1xM1w4&libraries=places"></script>

    <!-- Firebase SDK -->
    <script type="module" src="firebase-config.js"></script>
    <script src="app.js"></script>
</body>
</html>
